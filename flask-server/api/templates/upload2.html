<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <title>File Upload</title>

    <style>
       

        nav {
            width: 100%; /* Full width for the nav */
            background-color: black; /* Nav background color */
            backdrop-filter: blur;
            padding: 10px 0;
            margin-bottom: 20px; /* Space between nav and content */
            background: rgba(0, 0, 0, 0.8);
        }

        nav ul {
            display: flex;
            justify-content: center; /* Center the nav items horizontally */
            list-style-type: none; /* Remove bullet points */
            padding: 0;
            margin: 0;
        }

        nav ul li {
            margin: 0 15px; /* Space between each nav item */
        }

        nav ul li a {
            text-decoration: none;
            color: white; /* White text for links */
            font-weight: bold;
            padding: 10px 20px;
        }

        nav ul li a:hover {
            background-color: #0056b3; /* Darker background on hover */
            border-radius: 5px; /* Rounded corners on hover */
        }
        .frame2 {
    /* Styling for frame2 */
    border-radius: 10px;
    padding: 20px;
    background-color: rgb(189, 226, 249);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.8);
    text-align: center;
    width: 1350px;
    margin-bottom: 20px;
    height: 410px;
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center;
    display: flex; /* Flexbox to align items inside frame2 */
    flex-direction: column;
    align-items: center;
    justify-content: space-between; /* Adds some spacing inside frame2 */
}

.frame4-container {
    display: flex; /* Flexbox to align frame4 divs horizontally */
    justify-content: center; /* Center the frame4 divs */
    gap: 20px; /* Space between the two frame4 divs */
    margin-top: 30px; /* Add some margin from the content above */
}

.frame4 {
    border-radius: 10px;
    padding: 20px;
    background-color: lightgoldenrodyellow;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.8);
    text-align: center;
    width: 200px;
    margin-bottom: 20px;
    height: 150px;
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center;
}

        .frame3 {
 /* Frame border color */
            border-radius: 10px; /* Rounded corners for the frame */
            padding: 20px; /* Padding inside the frame */
            background-color:rgb(189, 226, 249); /* Background color of the frame */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.8); /* Shadow effect for the frame */
            text-align: center; /* Center text inside the frame */
            width: 600px; /* Width of the frame */
            margin-bottom: 20px; /* Add space below the frame */
            height: 150px;
            background-repeat: no-repeat;
            background-size: cover;
            background-position: center;
            margin-left: 350px;
        }
        .frame5{
            text-align: left; /* Center text inside the frame */
            width: 1600px; /* Width of the frame */
            height:50px;
            background-image:url('https://www.ilscompany.com/wp-content/uploads/Logistics-supplychainmngmnt-thumbnail.jpg');
            margin-left: 10px;

        }

        .frame {
            border: 2px solid #007bff; /* Frame border color */
            border-radius: 10px; /* Rounded corners for the frame */
            padding: 20px; /* Padding inside the frame */
            background-image: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSxN_XR5KlV5rrXY9wdUkZ1X8icUeunf6RE1w&s.jpghttps://png.pngtree.com/thumb_back/fh260/back_our/20190628/ourmid/pngtree-light-blue-background-image_264178.jpg'); /* Background color of the frame */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* Shadow effect for the frame */
            text-align: center; /* Center text inside the frame */
            width: 1000px; /* Width of the frame */
            margin-bottom: 20px; /* Add space below the frame */
            height: 800px;
            background-repeat: no-repeat;
            background-size: cover;
            background-position: center;
        }

        .frame h2 {
            margin-bottom: 20px; /* Spacing below the title */
        }

        .frame input[type="file"] {
            margin: 10px 0; /* Margin around the file input */
            width: 100%; /* Make the file input take full width */
            padding: 10px; /* Padding for better aesthetics */
            box-sizing: border-box; /* Ensure padding is included in width */
        }

        .frame input[type="submit"] {
            background-color: #007bff; /* Button background color */
            color: white; /* Button text color */
            border: none; /* No border */
            border-radius: 5px; /* Rounded corners */
            padding: 10px; /* Padding for the button */
            width: 100%; /* Make the button take full width */
            cursor: pointer; /* Pointer cursor on hover */
            margin-top: 10px; /* Space above the button */
        }

        .frame input[type="submit"]:hover {
            background-color: #0056b3; /* Darker shade on hover */
        }

        #uploaded-data, #summarization-info, #optimization-results, #demand-simulation-results {
            width: 80%; /* Content width */
            margin-bottom: 20px; /* Space between sections */
            border-radius: 10px; /* Rounded corners for the frame */
            padding: 20px; /* Padding inside the frame */
            background-color:rgb(189, 226, 249);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.8); /* Shadow effect for the frame */
            background-repeat: no-repeat;
            background-size: cover;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);

        }

        h1, h2, h5 {
            text-align: center;
            color: white;
        }
        h1 {
            text-align: center;
            color:black;
        }


        .table-responsive {
    width: 100%;
    overflow-x: auto;

    color:white;

}
.myDiv {
    border-radius: 10px; /* Rounded corners for the frame */
            padding: 20px; /* Padding inside the frame */
            background-color:rgb(189, 226, 249);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.8); /* Shadow effect for the frame */
  background-size: cover;
  background-repeat: no-repeat;
  width: 80%;
  color:white;
  align-items: center;
}
.mydiv2{
 margin-left: 12%;
 margin-right: 10%;
}
.mb-4 {
    margin-bottom: 1.5rem; /* Space between different file previews */
}

.text-danger {
    color: whitesmoke; /* Red color for filenames */
}

.table-responsive {
    overflow-x: auto;
     /* Enable horizontal scrolling for responsive design */
    margin-left: 20%;
    margin-right: 20%;
    color:white
}


.table {
    width: 60%; /* Full width for tables */
}

.table th {
    background-color: #007bff; /* Blue background for headers */
    color: white; /* White text for headers */
}

.table td {
    vertical-align: middle; /* Center cell content vertically */
}

.table-bordered {
    border: 1px solid #dee2e6; /* Light border for the table */
}

.table-striped tbody tr:nth-of-type(odd) {
    background-color: white; /* Set odd rows to white */
}

.table-striped tbody tr:nth-of-type(even) {
    background-color:lightgoldenrodyellow; /* Light gray for even rows (default) */
}
.content-section {
            width: 80%;
            margin: 20px auto;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.8); /* Light background for readability */
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

    </style>
</head>

<body style="background-image: url('https://img.freepik.com/free-vector/simple-blue-gradient-background-vector-business_53876-166894.jpg?size=626&ext=jpg&ga=GA1.1.237641234.1728726739&semt=ais_hybrid.jpg');
background-repeat: no-repeat;
background-size: cover;
background-position: center center;
min-height: 100vh;
width: 100%;
margin: 0;
display: flex;
flex-direction: column;
justify-content: flex-start;
align-items: center;">
    <div class="frame5">
    <h1 style="color:white; font-family:Georgia, 'Times New Roman', Times, serif;">Supply Chain Optimization</h1>
    </div>
    <!-- Navigation Menu -->
    <nav>
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/preview">Preview Uploaded Files</a></li>
            <li><a href="/summarize">Summarization</a></li>
            <li><a href="/demand_simulation">Demand Simulation</a></li>
            <li><a href="/countrywise">Countrywise Breakdown</a></li>
            <li><a href="/submit_new_files">Submit New Files</a></li>
            <li><a href="/preview_new">Preview New Files</a></li>
            <!-- New CO2 Tax Summarization Tab -->
            <li><a href="/summarize_tax">CO2 Tax Summarization</a></li>
        </ul>
    </nav>


    <!-- File upload form within a frame -->
    {% if show_upload_form %}
    <div>
        <div class="frame3">    
            <h3 style="color:black; font-family:Georgia, 'Times New Roman', Times, serif;">Upload Excel Files</h3>   
            <form action="/upload" method="post" enctype="multipart/form-data">
                <input type="file" name="files" multiple>
                <input type="submit" value="Upload">
            </form>
            <p style="color:black"><b>Select the files to get various optimization-results</b></p>
        </div>
        <div class="frame2">
            <h2 style="color:black; font-family:Georgia, 'Times New Roman', Times, serif;">About this app</h2>    
            <p>hello</p>
            
            <!-- Flexbox container for the frame4 elements -->
            <div class="frame4-container">
                <div class="frame4">
                    Content 1
                </div> 
                <div class="frame4">
                    Content 2
                </div>   
                <div class="frame4">
                    Content 1
                </div> 
                <div class="frame4">
                    Content 2
                </div>  
                <div class="frame4">
                    Content 1
                </div> 
                <div class="frame4">
                    Content 2
                </div>   
            </div>
        </div>
  </div>
    {% endif %}
<!-- Preview uploaded data -->
    {% if show_preview %}
    <div id="file-data-table-container" class="myDiv">
    {% if uploaded_data %}
        <h2 style="color:white">Uploaded Files Preview</h2>
        <div class="table-responsive">
            {{ uploaded_data | safe }}
        </div>
    {% else %}
    {% endif %}
    </div>

<!-- About This Application Section -->
      <div class="content-section">
         <h2>About This Application</h2>
            <p>This application helps optimize supply chain processes by allowing users to upload Excel files for analysis. It provides features like summarization, demand simulation, and country-wise breakdown of product flow.</p>
      </div>
{% endif %}
    <!-- Additional preview information (optional) -->
    {% if preview_info %}
        <h2 style="color:green"><b>Preview Details</b></h2>
        <div id="file-preview" class="myDiv">
            {{ preview_info | safe }}
        </div>
    {% endif %}

    <!-- Summarization Section -->
    {% if show_summarization %}
    <div id="summarization-info" class="myDiv">
        <h1 style="color:black; font-family:Georgia, 'Times New Roman', Times, serif;">Summarization</h1>
        {% if summary_info %}
            <p style="color: green;" ><b>Status: {{ summary_info.status }}</b></p>
            <p style="color: green;"><b>Objective Value: ₹{{ summary_info.objective_value }}</b></p>
            <p style="color: green;"><b>Fixed Costs: ₹{{ summary_info.fixed_costs }}</b></p>
            <p style="color: green;"><b>Variable Costs: ₹{{ summary_info.variable_costs }}</b></p>
        {% else %}
            <p>No summary available yet.</p>
        {% endif %}

        <!-- Plotly Plot -->
        {% if plot_html %}
            <div id="plot-container" class="mydiv2">
                {{ plot_html | safe }}
            </div>
        {% endif %}
    </div>
    {% endif %}

    <!-- Optimization results -->
    {% if optimization_results %}
    <div id="optimization-results">
        <h5 class="small-header">Optimization Results</h5>
        {{ optimization_results | safe }}
    </div>
    {% endif %}

    <!-- Demand simulation results -->
    {% if demand_simulation_results %}
    <div id="demand-simulation-results">
        <h2 style="color:black;font-family:Georgia, 'Times New Roman', Times, serif;">Demand Simulation Results</h2>
        {% if demand_simulation_results %}
            <div class="table-responsive" >
                {{ demand_simulation_results | safe }}
            </div>
            <a href="{{ demand_simulation_file_path }}" class="btn btn-primary" download >Download Demand Simulation Data</a>
        {% else %}
            <p>No results available yet.</p>
        {% endif %}

        <!-- Interactive plot -->
        {% if plot_path %}
        <h2  style="color:black;font-family:Georgia, 'Times New Roman', Times, serif;">Demand Simulation Plot</h2>
        <iframe src="{{ url_for('static', filename='uploads/demand_simulation_plot.html') }}" width="100%" height="600px"></iframe>
        {% else %}
        <p>No plot available.</p>
        {% endif %}

        <!-- Boolean Heatmap plot -->
        {% if plot_html_2 %}
            <h2  style="color:black;font-family:Georgia, 'Times New Roman', Times, serif;">Demand Simulation - Boolean Heatmap</h2>
            <div id="plot-container">
                {{ plot_html_2 | safe }}
            </div>
        {% else %}
            <p>No second plot available yet.</p>
        {% endif %}
             <!-- Unique Combination Plot (Matplotlib plot) -->
             {% if unique_combination_plot %}
             <h2  style="color:black;font-family:Georgia, 'Times New Roman', Times, serif;">Demand Simulation - Unique Combination Grid</h2>
             <div>
                 <img src="data:image/png;base64,{{ unique_combination_plot }}" alt="Unique Combination Plot">
             </div>
         {% else %}
             <p>No unique combination plot available yet.</p>
         {% endif %}
 
     </div>
    {% endif %}
    <!-- Country-wise Breakdown -->
    <div class="myDiv">
        {% if country_breakdown %}
           <div id="country-wise-breakdown">
               <h2  style="color:black;font-family:Georgia, 'Times New Roman', Times, serif;">Country-wise Breakdown of Product Flow</h2>
                 <div>{{ country_breakdown | safe }}</div>
            </div>
    {% else %}

    {% endif %}
    <!-- Amount Stacked Graph -->
<div style="text-align: center;">  <!-- Center alignment for the text and graphs -->
    {% if amount_fig %}
        <div id="amount-graph" class="mydiv2" style="display: inline-block;">  <!-- Inline block to center the graph -->
            <h2 style="color:black; font-family: Georgia, 'Times New Roman', Times, serif;">
                Amount of Products Received by Country
            </h2>
            <div>{{ amount_fig | safe }}</div>
        </div>
    {% endif %}
</div>

<!-- Cost Stacked Graph -->
<div style="text-align: center;">  <!-- Center alignment for the text and graphs -->
    {% if cost_fig %}
        <div id="cost-graph" class="mydiv2" style="display: inline-block;">  <!-- Inline block to center the graph -->
            <h2 style="color:black; font-family: Georgia, 'Times New Roman', Times, serif;">
                Cost of Products Received by Country
            </h2>
            <div>{{ cost_fig | safe }}</div>
        </div>
    {% endif %}

    <!-- File upload form within a frame -->
    {% if show_upload_new_form %}
    <div>
        <div class="frame3">    
            <h3 style="color:black; font-family:Georgia, 'Times New Roman', Times, serif;">Upload Excel Files</h3>   
            <form action="/submit_new_files" method="post" enctype="multipart/form-data">
                <input type="file" name="files" multiple>
                <input type="submit" value="Upload">
            </form>
            <p style="color:black"><b>Select the files to get various optimization-results</b></p>
        </div>
    </div>
    {% endif %}
    <div class="container mt-5">
        {% if show_upload_form %}
        <div class="file-upload-section">
            <h3 style="color:black">Upload Excel Files</h3>
            <form action="/submit_new_files" method="post" enctype="multipart/form-data">
                <input type="file" name="files" multiple class="form-control-file">
                <input type="submit" value="Upload" class="btn btn-primary mt-3">
            </form>
            <p style="color:black"><b>Select the files to get various optimization results</b></p>
        </div>
        {% endif %}
        
    {% if preview_new_info %}
        <h2 class="mt-5" style="color:green;text-align:center;">Uploaded Files Preview</h2>
        <div class="table-responsive text-center">
            {{ preview_new_info | safe }}
        </div>
    {% else %}
    {% endif %}
    {% if results and results_1 %}
    <div style="display: flex; justify-content: space-between;">

        <!-- Non-Tax Optimized Results -->
        <div style="width: 48%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; text-align: center;">
            <h1 style="color:black; font-family:Georgia, 'Times New Roman', Times, serif;">CO2 Tax Optimized Summarization</h1>
            <p style="color: green;"><b>Status: {{ results_1.status }}</b></p>
            <p style="color: green;"><b>Objective Value: ₹{{ results_1.objective_value }}</b></p>
            <p style="color: green;"><b>Fixed Costs: ₹{{ results_1.fixed_costs }}</b></p>
            <p style="color: green;"><b>Variable Costs: ₹{{ results_1.variable_costs }}</b></p>
            <p style="color: green;"><b>Freight Cost: ₹{{ results_1.freight_cost }}</b></p>
            <p style="color: green;"><b>CO2 Tax: ₹{{ results_1.tax }}</b></p>
            <p style="color: green;"><b>Total Cost: ₹{{ results_1.objective_value }}</b></p>
        </div>

        <!-- Tax Optimized Results -->
        <div style="width: 48%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; text-align: center;">
            <h1 style="color:black; font-family:Georgia, 'Times New Roman', Times, serif;">Non-Tax Optimized Summarization</h1>
            <p style="color: red;"><b>Status: {{ results.status }}</b></p>
            <p style="color: red;"><b>Objective Value: ₹{{ results.objective_value }}</b></p>
            <p style="color: red;"><b>Fixed Costs: ₹{{ results.fixed_costs }}</b></p>
            <p style="color: red;"><b>Variable Costs: ₹{{ results.variable_costs }}</b></p>
            <p style="color: red;"><b>Freight Cost: ₹{{ results.freight_cost }}</b></p>
            <p style="color: red;"><b>CO2 Tax: ₹{{ results.tax }}</b></p>
            <p style="color: red;"><b>Total Cost: ₹{{ results.objective_value + results.tax }}</b></p>
        </div>
    </div>

    <!-- Plot HTML -->
    <div style="margin-top: 20px; text-align: center;">
        {{ plot_html|safe }}  <!-- Render the plot -->
    </div>

{% else %}
    <p>No results available.</p>
{% endif %}


    </div>
</body>

</html>